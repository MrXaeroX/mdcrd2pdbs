# mdcrd2pdbs

One of the common problems that arise after molecular modelling in explicit
solvent has completed is the problem of selection of the most important solvent
molecules that can make sense during the trajectory analysis step. To address
this specific issue, we have developed a tool for fast analysis of solvent, and
unpacking the trajectory in MDCRD format to a set of PDB files with only the
relevant water molecules kept.

*mdcrd2pdbs* supports the following general command-line options:
* -topo: AMBER topology file generated by LEaP and used for modelling;
* -traj: AMBER trajectory file generated during the dynamics (may be incomplete);
* -start: index of the first snapshot to analyze (zero-based);
* -final: index of the last snapshot to analyze (zero-based);
* -out: output PDB sequence name (will add snapshot index and ".pdb" extension).

To select only relevant water molecules, a *condition* can be defined. The
condition is evaluated as true, when heavy solvent molecules (oxygens, for
water) are within the specified distance of the certain residue for a certain
percentage of the trajectory). The condition is defined by the command-line
arguments as follows:
* -cond_res: residue name (default is none which means no condition);
* -cond_within: maximum distance, in angstroms (default is 5.0);
* -cond_cutoff: integer percentage of trajectory (default is 10, i.e. 10%).

For example, running mdcrd2pdbs with the following options:
```mdcrd2pdbs -topo input.prmtop -traj production.mdcrd -start 0 -final 999 -out pdbtraj -cond_res FLN -cond_within 6 -cond_cutoff 25```
            
will result in processing of 1000 snapshots of the AMBER trajectory
"production.mdcrd", with the topology taken from "input.prmtop", starting from
the very first snapshot, and keeping only those water molecules that reside
within 6 angstroms of the fluoresceine (FLN) residue for at least quarter (25%)
of the whole trajectory. Program will output 1000 PDB files, from
"pdbtraj0001.pdb" to "pdbtraj1000.pdb".

This software is made available as is, and is distributed without warranty of
any kind, either expressed or implied. Should you have any questions and/or
suggestions, please feel free to contact the author, Alexander V. Popov.
